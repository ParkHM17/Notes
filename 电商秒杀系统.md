# 电商秒杀系统

## 概述

### 发现问题

- 高并发。
- 超卖。
- 恶意请求。
- 地址暴露。
- 数据库压力。

### 解决方案

- 单一职责：现在设计思想都是**先微服务，再分布式**的方式。例如：下单有订单服务，用户登录管理有用户服务。所以可以**把秒杀的代码业务逻辑放一起，单独建立数据库（秒杀库）**。

  单一职责的好处就是即使秒杀这一块的服务没抗住（秒杀库崩了，服务挂了），也不会影响到其他的服务。（强行高可用）

- 地址加密：如果链接地址提前暴露，可能会出现提前秒杀的情况。那是否可以做时间校验呢？如果知道了链接地址，就算有时间校验，**通过程序不断获取最新时间，可以在秒杀开始的一瞬间就发送N次请求**，用户根本就没有秒到的机会。**如何避免**？把**链接地址动态化**，通过MD5之类的加密算法加密随机的字符串生成链接地址，然后通过**前端代码获取链接地址经过后台校验**才能通过。

- Redis集群。

- Nginx。

- 恶意请求拦截：可以给重复访问的用户**限制访问次数或时间**。

- 资源静态化：秒杀一般都有特定的页面展示模板。前后端分离下，把能提前放入**CDN服务器**的东西都放进去，减少真正秒杀时候服务器的压力。

- 按钮控制：一般是置灰。

- 然后还没到秒杀的时候基本上服务器就挂了。这个时候就需要前端的配合，定时去请求你的后端服务器，获取最新的北京时间，到时间点再给按钮可用状态。

  按钮可以点击之后也得给他置灰几秒，不然他一样在开始之后一直点的。

- 限流：

- 库存预热：